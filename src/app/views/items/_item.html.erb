<% if defined? show_replying %>
  <div class="item-reply">
    <% if !item.replying.empty? %>
      <div class="item-reply-from">
        ğŸ“©è¿”ä¿¡å…ˆ
      </div>
      <% item.replying.each do |reply| %>
        <%= render 'items/item', item: reply %>
      <% end %>
    <% end %>
  </div>
<% end %>

<div class="item">
  <div class="item-owners">
    <div class="item-owners-account">
      <%= link_to account_path(item.account.name_id) do %>
        <div class="ioa-link">
          <% if false %>
            <%= image_tag image_url(aid: item.account.icon_key, type: 'icons'), class: 'ioa-icon' %>
          <% else %>
            <%= image_tag 'icon.webp', class: 'ioa-icon' %>
          <% end %>
          <div class="ioa-profile">
            <div class="ioa-name">
              <%= item.account.name %>
            </div>
            <div class="ioa-nameid">
              @<%= item.account.name_id %>
            </div>
          </div>
        </div>
      <% end %>
      <div class="ioa-badges">
        <div>ğŸ­</div>
        <div>ğŸ’•</div>
        <div>ğŸ«§</div>
        <div>ğŸŒˆ</div>
        <div>ğŸ’®</div>
        <div>ğŸ”°</div>
      </div>
      <div class="ioa-others">
        <div class="ioa-button-wrap">
          <div class="ioa-button">
            <% if @current_account && @current_account.following.exists?(item.account.id) %>
              <%= button_to("ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤", follow_path(item.account.name_id), method: :post) %>
            <% elsif @current_account %>
              <%= button_to("ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹", follow_path(item.account.name_id), method: :post) %>
            <% else %>
              <%= button_to('ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãƒ•ã‚©ãƒ­ãƒ¼', login_path, method: :get) %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="item-details">
    <div class="item-details-kind">
      <%# item.kind %>
    </div>
    <div class="item-details-kind">
      <%# item.kind %>
    </div>
    <div class="item-details-id">
    </div>
    <div class="item-details-date">
      <%= link_to item.created_at.strftime("%Yå¹´ %mæœˆ %dæ—¥ %kæ™‚ %Måˆ† %Sç§’"), item_path(item.aid) %>
    </div>
  </div>
  <div class="item-content">
    <%= item.content %>
  </div>
  <div class="item-media">
    <% item.images.each do |image| %>
      <%= image_tag image.image_url, class: 'item-image' %>
    <% end %>
    <% if false %>
      <video controls class='video-view' id='video-<%= video.video_id %>'></video>
      <script src="https://cdn.jsdelivr.net/npm/hls.js@1"></script>
      <script>
        var video = document.getElementById('video-<%= video.video_id %>');
        var videoSrc = 'http://localhost:9000/development/variants/accounts/00000000000000/videos/<%= video.video_id %>/output.m3u8';
        if (Hls.isSupported()) {
          var hls = new Hls();
          hls.loadSource(videoSrc);
          hls.attachMedia(video);
        }
      </script>
    <% end %>
  </div>
  <div style="text-align:right; font-size:11px;">
    <%= link_to item.aid, item_path(item.aid) %>
  </div>
  <div class="item-reactions">
    <% item.emojis.each do |emoji| %>
      <div class="item-reaction">
        <%= button_to react_path(item.aid, emoji.aid), method: :post do %>
          <% if false %>
            <%= image_tag image_url(model: 'emojis', type: 'tb-emojis', aid: emoji.aid), class: '' %>
          <% else %>
            <%= emoji.name %>
          <% end %>
          <span><%= item.reactions.where(emoji_id: emoji.id).size %></span>
        <% end%>
      </div>
    <% end %>
  </div>
  <div class="item-panel">
    <div class="item-tab">
      <input id="aid_<%= item.aid %>_tab_replying" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_replying">è¿”ä¿¡å…ˆ<%= item.replying.size %></label>
      <input id="aid_<%= item.aid %>_tab_replies" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_replies">è¿”ä¿¡<%= item.repliers.size %></label>
      <input id="aid_<%= item.aid %>_tab_diffusions" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_diffusions">æ‹¡æ•£<%= 0 %></label>
      <input id="aid_<%= item.aid %>_tab_quoting" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_quoting">å¼•ç”¨å…ƒ<%= item.quoting.size %></label>
      <input id="aid_<%= item.aid %>_tab_quoters" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_quoters">å¼•ç”¨<%= item.quoters.size %></label>
      <input id="aid_<%= item.aid %>_tab_reactions" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_reactions">ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³<%= item.reactions.size %></label>
      <input id="aid_<%= item.aid %>_tab_share" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_share">å…±æœ‰</label>
      <input id="aid_<%= item.aid %>_tab_save" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_save">ä¿å­˜</label>
      <input id="aid_<%= item.aid %>_tab_others" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_others">ãã®ä»–</label>
      <details>
        <summary>è©³ã—ã</summary>
        <div id="aid_<%= item.aid %>_tab_replying_content" class="tab_content">
          è¿”ä¿¡å…ˆã®è¡¨ç¤º
          <% if !item.replying.empty? %>
            <div class="item-reply-from">
              ğŸ“©è¿”ä¿¡å…ˆ
            </div>
            <% item.replying.each do |reply| %>
              <%= link_to reply.aid, item_path(reply.aid) %>
            <% end %>
          <% else %>
            è¿”ä¿¡å…ˆã¯ã‚ã‚Šã¾ã›ã‚“
          <% end %>
        </div>
        <div id="aid_<%= item.aid %>_tab_replies_content" class="tab_content">
          <%= link_to 'è¿”ä¿¡ã™ã‚‹', item_reply_path(item.aid) %>
          <%# render 'items/form', initial_replied: item.aid %>
        </div>
        <div id="aid_<%= item.aid %>_tab_diffusions_content" class="tab_content">
          æ‹¡æ•£ã™ã‚‹
          <%= button_to 'æ‹¡æ•£ã™ã‚‹' %>
        </div>
        <div id="aid_<%= item.aid %>_tab_quoting_content" class="tab_content">
          å¼•ç”¨å…ƒã®è¡¨ç¤º
          <% if !item.quoting.empty? %>
            <div class="item-quote-from">
              ğŸ“©å¼•ç”¨å…ƒ
            </div>
            <% item.quoting.each do |quote| %>
              <%= link_to quote.aid, item_path(quote.aid) %>
            <% end %>
          <% else %>
            å¼•ç”¨å…ƒã¯ã‚ã‚Šã¾ã›ã‚“
          <% end %>
        </div>
        <div id="aid_<%= item.aid %>_tab_quoters_content" class="tab_content">
          <%= link_to 'å¼•ç”¨ã™ã‚‹', item_quote_path(item.aid) %>
          <%# render 'items/form', initial_quoted: item.aid %>
        </div>
        <div id="aid_<%= item.aid %>_tab_reactions_content" class="tab_content">
          <%= link_to 'ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã™ã‚‹', item_quote_path(item.aid) %>
          <%# Emoji.all.each do |emoji| %>
            <%# button_to react_path(item.aid, emoji.aid), method: :post do %>
              <%# if false %>
                <%# image_tag image_url(model: 'emojis', type: 'tb-emojis', aid: emoji.aid), class: '' %>
              <%# else %>
                <%# emoji.name %>
              <%# end %>
            <%# end%>
          <%# end %>
        </div>
        <div id="aid_<%= item.aid %>_tab_share_content" class="tab_content">
          å…±æœ‰ã™ã‚‹
          https://amiverse.net/items/<%= item.aid %>
        </div>
        <div id="aid_<%= item.aid %>_tab_save_content" class="tab_content">
          ä¿å­˜ã™ã‚‹
          ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯
        </div>
        <div id="aid_<%= item.aid %>_tab_others_content" class="tab_content">
          ãã®ä»–
          ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹
          åŸ‹ã‚è¾¼ã‚€
          å ±å‘Š
        </div>
      </details>
      <style>
        #aid_<%= item.aid %>_tab_replying:checked ~ details #aid_<%= item.aid %>_tab_replying_content,
        #aid_<%= item.aid %>_tab_replies:checked ~ details #aid_<%= item.aid %>_tab_replies_content,
        #aid_<%= item.aid %>_tab_diffusions:checked ~ details #aid_<%= item.aid %>_tab_diffusions_content,
        #aid_<%= item.aid %>_tab_quoting:checked ~ details #aid_<%= item.aid %>_tab_quoting_content,
        #aid_<%= item.aid %>_tab_quoters:checked ~ details #aid_<%= item.aid %>_tab_quoters_content,
        #aid_<%= item.aid %>_tab_reactions:checked ~ details #aid_<%= item.aid %>_tab_reactions_content,
        #aid_<%= item.aid %>_tab_share:checked ~ details #aid_<%= item.aid %>_tab_share_content,
        #aid_<%= item.aid %>_tab_save:checked ~ details #aid_<%= item.aid %>_tab_save_content,
        #aid_<%= item.aid %>_tab_others:checked ~ details #aid_<%= item.aid %>_tab_others_content {
            display: block;
        }
      </style>
    </div>
  </div>
</div>

<% if defined? show_repliers %>
  <div class="item-reply">
    <% if !item.repliers.empty? %>
      <div class="item-reply-from">
        ğŸ“©è¿”ä¿¡
      </div>
      <% item.repliers.each do |reply| %>
        <%= render 'items/item', item: reply %>
      <% end %>
    <% end %>
  </div>
<% end %>