<% if defined? show_replying %>
  <div class="item-reply">
    <% if !item.replying.empty? %>
      <div class="item-reply-from">
        ğŸ“©è¿”ä¿¡å…ˆ
      </div>
      <% item.replying.each do |reply| %>
        <%= render 'items/item', item: reply %>
      <% end %>
    <% end %>
  </div>
<% end %>

<div class="item">
  <div class="item-owners">
    <div class="item-owners-account">
      <%= link_to account_path(item.account.name_id) do %>
        <div class="ioa-link">
          <% if false %>
            <%= image_tag image_url(aid: item.account.icon_id, type: 'icons'), class: 'ioa-icon' %>
          <% else %>
            <%= image_tag 'icon.webp', class: 'ioa-icon' %>
          <% end %>
          <div class="ioa-profile">
            <div class="ioa-name">
              <%= item.account.name %>
            </div>
            <div class="ioa-nameid">
              @<%= item.account.name_id %>
            </div>
          </div>
        </div>
      <% end %>
      <div class="ioa-badges">
        <div>ğŸ­</div>
        <div>ğŸ’•</div>
        <div>ğŸ«§</div>
        <div>ğŸŒˆ</div>
        <div>ğŸ’®</div>
        <div>ğŸ”°</div>
      </div>
      <div class="ioa-others">
        <div class="ioa-button-wrap">
          <div class="ioa-button">ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹</div>
        </div>
      </div>
    </div>
  </div>
  <div class="item-details">
    <div class="item-details-kind">
      <%# item.kind %>
    </div>
    <div class="item-details-kind">
      <%# item.kind %>
    </div>
    <div class="item-details-id">
      <%= link_to item.aid, item_path(item.aid) %>
    </div>
    <div class="item-details-date">
      <%= item.created_at.strftime("%Yå¹´ %mæœˆ %dæ—¥ %kæ™‚ %Måˆ† %Sç§’") %>
    </div>
  </div>
  <div class="item-content">
    <%= item.content %>
  </div>
  <div class="item-media">
    <% item.images.each do |image| %>
      <%= image_tag image_url(aid: image.aid), class: 'item-image' %>
    <% end %>
    <% if false %>
      <video controls class='video-view' id='video-<%= video.video_id %>'></video>
      <script src="https://cdn.jsdelivr.net/npm/hls.js@1"></script>
      <script>
        var video = document.getElementById('video-<%= video.video_id %>');
        var videoSrc = 'http://localhost:9000/development/variants/accounts/00000000000000/videos/<%= video.video_id %>/output.m3u8';
        if (Hls.isSupported()) {
          var hls = new Hls();
          hls.loadSource(videoSrc);
          hls.attachMedia(video);
        }
      </script>
    <% end %>
  </div>
  <div class="item-reactions">
    <% item.emojis.each do |emoji| %>
      <div class="item-reaction">
        <%= button_to react_path(item.aid, emoji.aid), method: :post do %>
          <% if emoji.custom %>
            <%= image_tag image_url(model: 'emojis', type: 'tb-emojis', aid: emoji.aid), class: '' %>
          <% else %>
            <%= emoji.name %>
          <% end %>
          <span><%= item.reactions.where(emoji_id: emoji.id).count %></span>
        <% end%>
      </div>
    <% end %>
  </div>
  <div class="item-panel">
    <div class="item-tab">
      <input id="aid_<%= item.aid %>_tab_replying" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_replying">è¿”ä¿¡å…ˆ<%= item.replying.count %></label>
      <input id="aid_<%= item.aid %>_tab_repliers" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_repliers">è¿”ä¿¡<%= item.repliers.count %></label>
      <input id="aid_<%= item.aid %>_tab_quoters" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_quoters">å¼•ç”¨<%= item.quoters.count %></label>
      <input id="aid_<%= item.aid %>_tab_reactions" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_reactions">ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³<%= item.reactions.count %></label>
      <input id="aid_<%= item.aid %>_tab_share" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_share">å…±æœ‰</label>
      <input id="aid_<%= item.aid %>_tab_save" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_save">ä¿å­˜</label>
      <input id="aid_<%= item.aid %>_tab_others" type="radio" name="tab_menu">
      <label class="tab_menu" for="aid_<%= item.aid %>_tab_others">ãã®ä»–</label>
      <details>
        <summary>è©³ã—ã</summary>
        <div id="aid_<%= item.aid %>_tab_replying_content" class="tab_content">
          è¿”ä¿¡å…ˆã®è¡¨ç¤º
          <% if !item.replying.empty? %>
            <div class="item-reply-from">
              ğŸ“©è¿”ä¿¡å…ˆ
            </div>
            <% item.replying.each do |reply| %>
              <%= reply.aid %>
            <% end %>
          <% else %>
            è¿”ä¿¡å…ˆã¯ã‚ã‚Šã¾ã›ã‚“
          <% end %>
        </div>
        <div id="aid_<%= item.aid %>_tab_repliers_content" class="tab_content">
          è¿”ä¿¡ã™ã‚‹
          <%= render 'items/form', initial_replied: item.aid %>
        </div>
        <div id="aid_<%= item.aid %>_tab_quoters_content" class="tab_content">
          å¼•ç”¨ã™ã‚‹
          <%= render 'items/form', initial_quoted: item.aid %>
        </div>
        <div id="aid_<%= item.aid %>_tab_reactions_content" class="tab_content">
          ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã™ã‚‹
          <% Emoji.all.each do |emoji| %>
            <%= button_to react_path(item.aid, emoji.aid), method: :post do %>
              <% if emoji.custom %>
                <%= image_tag image_url(model: 'emojis', type: 'tb-emojis', aid: emoji.aid), class: '' %>
              <% else %>
                <%= emoji.name %>
              <% end %>
            <% end%>
          <% end %>
        </div>
        <div id="aid_<%= item.aid %>_tab_share_content" class="tab_content">
          å…±æœ‰ã™ã‚‹
          https://amiverse.net/items/<%= item.aid %>
        </div>
        <div id="aid_<%= item.aid %>_tab_save_content" class="tab_content">
          ä¿å­˜ã™ã‚‹
          ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯
        </div>
        <div id="aid_<%= item.aid %>_tab_others_content" class="tab_content">
          ãã®ä»–
          ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹
          åŸ‹ã‚è¾¼ã‚€
          å ±å‘Š
        </div>
      </details>
      <style>
        #aid_<%= item.aid %>_tab_replying:checked ~ details #aid_<%= item.aid %>_tab_replying_content,
        #aid_<%= item.aid %>_tab_repliers:checked ~ details #aid_<%= item.aid %>_tab_repliers_content,
        #aid_<%= item.aid %>_tab_quoters:checked ~ details #aid_<%= item.aid %>_tab_quoters_content,
        #aid_<%= item.aid %>_tab_reactions:checked ~ details #aid_<%= item.aid %>_tab_reactions_content,
        #aid_<%= item.aid %>_tab_share:checked ~ details #aid_<%= item.aid %>_tab_share_content,
        #aid_<%= item.aid %>_tab_save:checked ~ details #aid_<%= item.aid %>_tab_save_content,
        #aid_<%= item.aid %>_tab_others:checked ~ details #aid_<%= item.aid %>_tab_others_content {
            display: block;
        }
      </style>
    </div>
  </div>
</div>

<% if defined? show_repliers %>
  <div class="item-reply">
    <% if !item.repliers.empty? %>
      <div class="item-reply-from">
        ğŸ“©è¿”ä¿¡
      </div>
      <% item.repliers.each do |reply| %>
        <%= render 'items/item', item: reply %>
      <% end %>
    <% end %>
  </div>
<% end %>